(this["webpackJsonpstrapi-crud-frontend"]=this["webpackJsonpstrapi-crud-frontend"]||[]).push([[0],{29:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(21),s=n.n(a),o=(n(29),n(11)),i=n(5),u=n(53),p=n(54),j=n(4),l=n(0),h=Object(r.createContext)(null),d=function(e){var t=e.children,n=Object(r.useState)(null),c=Object(j.a)(n,2),a=c[0],s=c[1];return Object(l.jsx)(h.Provider,{value:{user:a,setUser:s},children:t})},b=function(){var e=Object(r.useContext)(h).user;return Object(l.jsxs)("div",{className:"Nav",children:[Object(l.jsx)(o.c,{to:"/",exact:!0,children:" Home "}),e&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(o.c,{to:"/create",exact:!0,className:"alink",children:" Create "}),Object(l.jsx)(o.c,{to:"/logout",exact:!0,children:" Logout "})]}),!e&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(o.c,{to:"/login",exact:!0,children:" Login "}),Object(l.jsx)(o.c,{to:"/signup",exact:!0,children:" Signup "})]})]})},f=n(2),O=n.n(f),x=n(6),v=function(e){var t=e.likes,n=e.description,r=e.url;return Object(l.jsxs)("div",{className:"Post",children:[Object(l.jsx)("img",{className:"Post_Image",src:function(e){return"".concat("https://strapi-crud.herokuapp.com").concat(e)}(r)}),Object(l.jsx)("h4",{children:n}),Object(l.jsx)("div",{children:Object(l.jsxs)("span",{children:["Likes: ",t]})})]})},m=function(){var e=Object(r.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){(function(){var e=Object(x.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strapi-crud.herokuapp.com/posts");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(l.jsx)("div",{className:"Home",children:n.map((function(e){return Object(l.jsx)(o.b,{to:"/".concat(e.id),children:Object(l.jsx)(v,{likes:e.likes,description:e.description,url:e.image&&e.image.url})})}))})},g=function(){var e=Object(r.useState)(""),t=Object(j.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),s=Object(j.a)(a,2),o=s[0],i=s[1],u=Object(r.useState)(""),p=Object(j.a)(u,2),d=p[0],b=p[1];console.log("file",o);var f=Object(r.useContext)(h).user,v=function(){var e=Object(x.a)(O.a.mark((function e(t){var r,c,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f){e.next=4;break}return b("Please log in first"),e.abrupt("return");case 4:if(n){e.next=7;break}return b("Please add a description"),e.abrupt("return");case 7:if(o){e.next=10;break}return b("Please add a file"),e.abrupt("return");case 10:return(r=new FormData).append("data",JSON.stringify({description:n})),r.append("files.image",o),e.prev=13,e.next=16,fetch("https://strapi-crud.herokuapp.com/posts",{method:"POST",headers:{Authorization:"Bearer ".concat(f.jwt)},body:r});case 16:return c=e.sent,e.next=19,c.json();case 19:a=e.sent,console.log("data",a),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(13),console.log("Exception ",e.t0),b(e.t0);case 27:case"end":return e.stop()}}),e,null,[[13,23]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"Create",children:[Object(l.jsx)("h2",{children:"Create"}),d&&Object(l.jsx)("p",{children:d}),Object(l.jsxs)("form",{onSubmit:v,children:[Object(l.jsx)("input",{placeholder:"Description",value:n,onChange:function(e){b(""),c(e.target.value)}}),Object(l.jsx)("input",{type:"file",placeholder:"Add a File",onChange:function(e){b(""),i(e.target.files[0])}}),Object(l.jsx)("button",{children:"Submit"})]})]})},k=Object(r.createContext)(null),w=function(e){var t=e.children,n=Object(r.useContext)(h).user,c=Object(r.useState)([]),a=Object(j.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)([]),u=Object(j.a)(i,2),p=u[0],d=u[1],b=function(){n&&(function(){var e=Object(x.a)(O.a.mark((function e(){var t,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strapi-crud.herokuapp.com/likes/given?user=".concat(n.user.id),{headers:{Authorization:"Bearer ".concat(n.jwt)}});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,o(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){var e=Object(x.a)(O.a.mark((function e(){var t,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strapi-crud.herokuapp.com/likes/received?post.author=".concat(n.user.id),{headers:{Authorization:"Bearer ".concat(n.jwt)}});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,d(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()())};return Object(r.useEffect)((function(){b()}),[n]),console.log("likesGiven",s),console.log("likesReceived",p),Object(l.jsx)(k.Provider,{value:{likesGiven:s,likesReceived:p,reloader:b},children:t})},S=function(e){var t=e.match,n=e.history,c=Object(r.useState)(""),a=Object(j.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(!0),u=Object(j.a)(i,2),p=u[0],d=u[1],b=Object(r.useState)(""),f=Object(j.a)(b,2),m=f[0],g=f[1],w=Object(r.useState)(!1),S=Object(j.a)(w,2),y=S[0],C=S[1],E=Object(r.useState)(""),N=Object(j.a)(E,2),P=N[0],L=N[1],F=Object(r.useContext)(h),D=F.user,T=(F.setUser,Object(r.useContext)(k)),A=T.likesGiven,B=T.reloader,z=t.params.id,J=A&&A.find((function(e){return e.post&&e.post.id==z}));console.log("user",D),console.log("isPostAlreadyLiked:",J);var U=function(){var e=Object(x.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strapi-crud.herokuapp.com/posts/".concat(z));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,console.log("data",n),o(n),L(n.description),d(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),d(!1),g("404 - not found");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){U()}),[]);var I=function(){var e=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strapi-crud.herokuapp.com/posts/".concat(z),{method:"DELETE",headers:{Authorization:"Bearer ".concat(D.jwt)}});case 3:return t=e.sent,e.next=6,t.json();case 6:e.sent,n.push("/"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error in delete:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(x.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("in handleEditSubmit"),e.prev=2,e.next=5,fetch("https://strapi-crud.herokuapp.com/posts/".concat(z),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(D.jwt)},body:JSON.stringify({description:P})});case 5:return n=e.sent,e.next=8,n.json();case 8:r=e.sent,U(),console.log("handleEditSubmit data",r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("error:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(x.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strapi-crud.herokuapp.com/likes",{method:"POST",headers:{Authorization:"Bearer ".concat(D.jwt),"Content-Type":"application/json"},body:JSON.stringify({post:parseInt(z)})});case 3:e.sent,U(),B(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Exception ",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(x.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strapi-crud.herokuapp.com/likes/".concat(z),{method:"DELETE",headers:{Authorization:"Bearer ".concat(D.jwt)}});case 3:e.sent,U(),B(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Exception ",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"Post piokatw",children:[p&&Object(l.jsx)("p",{children:"Loading..."}),!p&&Object(l.jsx)(l.Fragment,{children:s.id&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(v,{likes:s.likes,description:s.description,url:s.image&&s.image.url}),D&&Object(l.jsxs)(l.Fragment,{children:[J&&Object(l.jsx)("button",{onClick:H,children:"Remove Like"}),!J&&Object(l.jsx)("button",{onClick:R,children:"Like"})]}),D&&D.user&&s&&s.author&&s.author.id===D.user.id&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("button",{onClick:I,children:"Delete this post"}),Object(l.jsx)("button",{onClick:function(){return C(!0)},children:"Edit this post"}),y&&Object(l.jsxs)("form",{onSubmit:G,children:[Object(l.jsx)("input",{value:P,onChange:function(e){return L(e.target.value)},placeholder:"New Description"}),Object(l.jsx)("button",{children:"Confirm"})]})]})]})}),m&&Object(l.jsx)("p",{children:m})]})},y=n(24),C=n.n(y),E=function(e){var t=e.history,n=Object(r.useState)(""),c=Object(j.a)(n,2),a=c[0],s=c[1],o=Object(r.useState)(""),i=Object(j.a)(o,2),u=i[0],p=i[1],d=Object(r.useState)(""),b=Object(j.a)(d,2),f=b[0],v=b[1],m=Object(r.useContext)(h),g=m.user,k=m.setUser;Object(r.useEffect)((function(){g&&(C.a.set("user",{user:g.user.email}),t.push("/"))}),[g]);var w=function(){var e=Object(x.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("https://strapi-crud.herokuapp.com/auth/local/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({identifier:a,password:u})});case 4:return n=e.sent,e.next=7,n.json();case 7:if(r=e.sent,console.log("login user",r),!r.message){e.next=12;break}return v(r.message[0].messages[0].message),e.abrupt("return");case 12:k(r),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),v("Something went wrong "+e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"piokatw",children:[Object(l.jsx)("h2",{children:"Login"}),Object(l.jsxs)("form",{onSubmit:w,children:[Object(l.jsx)("input",{type:"email",value:a,onChange:function(e){v(""),s(e.target.value)}}),Object(l.jsx)("input",{type:"password",value:u,onChange:function(e){v(""),p(e.target.value)}}),Object(l.jsx)("button",{children:"Login"})]}),f&&Object(l.jsx)("p",{children:f})]})},N=function(e){return e.history.push("/"),Object(l.jsx)("h2",{children:"Logout..."})},P=function(e){var t=e.history,n=Object(r.useState)(""),c=Object(j.a)(n,2),a=c[0],s=c[1],o=Object(r.useState)(""),i=Object(j.a)(o,2),u=i[0],p=i[1],d=Object(r.useState)(""),b=Object(j.a)(d,2),f=b[0],v=b[1],m=Object(r.useContext)(h),g=m.user,k=m.setUser;Object(r.useEffect)((function(){g&&t.push("/")}),[g]);var w=function(){var e=Object(x.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("https://strapi-crud.herokuapp.com/auth/local/register",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({username:a,email:a,password:u})});case 4:return n=e.sent,e.next=7,n.json();case 7:if(r=e.sent,console.log("data",r),!r.message){e.next=12;break}return v(r.message[0].messages[0].message),e.abrupt("return");case 12:k(r),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),v("Something went wrong "+e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"piokatw",children:[Object(l.jsx)("h2",{children:"Signup"}),Object(l.jsxs)("form",{onSubmit:w,children:[Object(l.jsx)("input",{type:"email",value:a,onChange:function(e){v(""),s(e.target.value)}}),Object(l.jsx)("input",{type:"password",value:u,onChange:function(e){v(""),p(e.target.value)}}),Object(l.jsx)("button",{children:"Signup"})]}),f&&Object(l.jsx)("p",{children:f})]})};n(49);var L=function(){return Object(l.jsx)(u.a,{fluid:!0,children:Object(l.jsxs)(o.a,{children:[Object(l.jsx)(p.a,{md:10,className:"rows",children:Object(l.jsx)(b,{})}),Object(l.jsx)(p.a,{md:12,children:Object(l.jsxs)(i.c,{children:[Object(l.jsx)(i.a,{path:"/",exact:!0,component:m}),Object(l.jsx)(i.a,{path:"/create",exact:!0,component:g}),Object(l.jsx)(i.a,{path:"/login",exact:!0,component:E}),Object(l.jsx)(i.a,{path:"/signup",exact:!0,component:P}),Object(l.jsx)(i.a,{path:"/logout",exact:!0,component:N}),Object(l.jsx)(i.a,{path:"/:id",exact:!0,component:S})]})})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,55)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(d,{children:Object(l.jsxs)(w,{children:["  ",Object(l.jsx)(L,{})]})})}),document.getElementById("root")),F()}},[[50,1,2]]]);
//# sourceMappingURL=main.c376ef0f.chunk.js.map